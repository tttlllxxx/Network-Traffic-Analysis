## 摘要

高级持续性威胁（APT）攻击因其隐蔽性强、链条复杂、行为多样而对传统检测方法构成挑战。行为画像作为揭示APT攻击过程的关键技术，其质量直接影响检测系统的实用性与响应效率。本文提出一套系统化、可量化、可对比的APT攻击行为画像评价指标体系，涵盖准确性、完整性、时效性、可解释性、泛化能力、可操作性等八大维度，构建标准化评分机制。实验以多种主流检测模型为基础，验证所建指标体系的适应性和科学性，为APT防御系统的模型评估与优化提供了理论支持与实践工具。

## 1. 引言

近年来，APT攻击频发，成为国家级黑客组织和高价值目标之间网络对抗的主要形式。APT攻击通常具有高度定制化、持续性强、链条复杂等特点，使得传统基于特征或规则的检测方式难以奏效。

APT行为画像技术通过对攻击者行为序列建模，从多维特征层面还原其攻击路径和策略，是一种有效的攻击理解与溯源手段。然而，目前针对行为画像的质量评估仍较为主观，缺乏系统、标准、可复现的评价方法。

**本文主要贡献如下：**

- 提出一套完整的APT攻击行为画像评价指标体系，覆盖八大核心维度；
- 设计标准化计算方法和评分模型；
- 在多个主流APT检测与建模方法上进行了对比实验与分析；
- 提供可视化图表与自动化评分脚本，具备工程应用价值。

## 2. 相关工作综述

### 2.1 APT行为画像建模技术

APT行为画像是对攻击者行为轨迹的结构化建模过程，其本质在于对攻击路径、攻击手段和攻击意图的抽象表达。

目前常见的行为画像建模技术包括：

- **基于日志/事件序列分析的方法**  
  如利用主机日志、网络日志等信息提取行为序列，常用技术包括时间序列建模（如LSTM）、频繁模式挖掘（FPM）等。

- **基于图结构建模的方法**  
  近年来大量研究基于图神经网络（GNN）、异构信息图（HIN）等对APT攻击链进行建模，将主机、文件、IP等节点及其交互建为动态图或因果图，进而生成画像。

- **基于攻击链理论建模的方法**  
  借助Kill Chain、MITRE ATT&CK、Diamond Model等攻击链框架，将攻击过程分阶段建模，以构建阶段性行为画像，便于分析攻击意图与演化趋势。

代表性工作如：  
- Liu et al.（2022）提出的GNN-APT模型，通过图神经网络捕捉多主机之间的攻击路径结构特征；
- Wang et al.（2021）构建了基于MITRE ATT&CK的行为聚合系统，实现攻击链级别的行为摘要生成。

### 2.2 APT检测方法与画像质量输出

目前主流APT检测方法大致可分为三类：

- **基于规则/专家系统**  
  如Snort/Suricata等入侵检测系统，依赖预定义攻击特征或行为规则，但对新型APT威胁识别能力有限。

- **基于机器学习与深度学习方法**  
  包括随机森林、XGBoost、LSTM、Autoencoder、Transformer等，用于从流量、日志等原始数据中自动学习行为模式，近年来逐渐成为主流。

- **基于图分析/图神经网络方法**  
  强调攻击路径之间的结构依赖与交互逻辑建模，已被证明在多主机APT检测中具有优势。

尽管大量研究关注检测精度与召回率，但对输出结果——行为画像本身的结构质量、完整性、可解释性等研究仍不充分，大多作为检测过程的“附加产物”，缺乏系统性的后评估。

### 2.3 行为画像评价相关研究

当前对于APT行为画像的评价方法研究仍处于起步阶段，存在以下问题：

1. **缺乏统一指标体系**：不同研究关注点分散，评价维度多为精度与覆盖率，缺乏对可解释性、时效性等维度的深入建模；
2. **评估方式主观性强**：许多评价依赖专家经验或人眼判断，不具备可复现性与可量化特征；
3. **缺少跨模型对比机制**：不同模型输出的画像结构差异大，难以统一评估标准，限制了横向对比分析。

部分研究尝试使用图复杂度、阶段覆盖率等指标对画像进行初步评分，但尚未形成成熟体系。如Chen et al.（2020）设计了用于攻击路径“连贯性”的评分函数，但未考虑泛化能力与部署性能。

### 2.4 APT攻击链标准

APT行为建模往往以MITRE ATT&CK、Kill Chain、Diamond Model等框架为参考，进行攻击阶段与技术的抽象。

### 2.5 当前存在的问题

- 缺乏统一指标体系：不同模型难以对比；
- 多依赖人工专家经验打分，主观性强；
- 忽略了画像生成时延、可解释性、可操作性等实用因素。

## 3. 评价指标体系设计

本指标体系共分为 **8类维度**，如下表所示：

| 维度 | 指标名称 | 简要说明 |
|------|----------|----------|
| 准确性 | 行为识别精度（BIA）<br>攻击阶段匹配度（SMS） | 是否准确识别攻击行为与阶段 |
| 完整性 | 攻击链覆盖率（KCC）<br>技术多样性（TD） | 是否还原完整攻击链 |
| 时效性 | 画像生成时延（PL）<br>行为滞后率（BLR） | 是否能及时反应 |
| 可解释性 | 攻击路径清晰度（APC）<br>可视化评分（VS） | 安全人员是否容易理解 |
| 泛化能力 | 未知行为检测率（UBDR）<br>抗扰动能力（PR） | 面对新型APT是否有效 |
| 可操作性 | 对策推荐率（CRR）<br>事件关联能力（ICC） | 是否能辅助决策 |
| 可扩展性 | 并发处理能力（CPT）<br>多源整合能力（MIS） | 支持大规模部署 |
| 资源开销 | 平均资源消耗（ARU）<br>存储效率（SE） | 工程部署成本评估 |

### 3.1 指标计算方法举例

$BIA = \frac{\text{正确识别的APT行为数量}}{\text{总行为数量}}$
$KCC = \frac{\text{画像中涉及的攻击链步骤数}}{\text{标准攻击链总步骤数}}$
$PL = t_{end} - t_{start}$
APC 可使用图复杂度 + 路径连通性度量
PR 通过添加少量数据扰动观察指标变化

### 3.2 指标标准化与评分机制

- 所有指标规范为 0~1 或 1~5 分量化；
- 支持打分雷达图、热力图表示模型优劣；
- 多模型可统一对比。

## 4. 实验与评估（是否需要？）

### 4.1 实验数据集与建模方法

- 使用CIC-IDS 2018、APT-Log、生成式APT模拟数据；
- 比较方法：GNN-Based模型、LSTM序列建模、传统聚类法。
### 4.2 实验流程

- 生成行为画像 → 输入本指标体系 → 打分 → 对比可视化

### 4.3 实验结果

- GNN模型在完整性和可扩展性上表现优异；
- LSTM方法时效性较差但识别精度高；
- 图模型路径清晰度与可解释性更强；

## 5. 分析与讨论

- 画像质量不仅需精度高，还要多维协同；
- 部分指标可按应用场景赋予不同权重；
- 当前系统对“图结构画像”支持最好，对文本画像支持需扩展。

## 6. 结论与展望

本文提出一套适用于APT行为画像系统的完整、多维评价指标体系，并通过实证验证其可操作性和科学性。未来将引入更多自动化评分机制、与安全编排响应平台联动的模块，以及可定制权重的评价工具集，助力APT防御系统的实际部署与评估。