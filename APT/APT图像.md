 **APT图像**是把**APT攻击行为的数据（例如事件、流量、系统调用等）转化成可视化图像**，目的是：

- 更好地表达攻击链
- 用于深度学习模型训练、分析或检测
- 用“图像方式”让AI和人类更容易理解复杂行为
  
APT攻击是一个复杂行为序列，表现形式为流量（pcap），行为日志，直接看起来混乱复杂。把行为图像化，进行深度学习识别检测评估。

|图像类型|数据来源|表达方式|类比图像|
|---|---|---|---|
|**系统调用图像**|主机行为日志|将不同调用/行为编码成灰度/彩色图|MNIST/手写字图|
|**流量可视化图**|网络流量数据（如PCAP）|将流量包的统计或特征值转为像素值|热图|
|**攻击路径拓扑图**|安全事件+攻击链|节点为攻击行为，边为关系|拓扑结构图、知识图谱图|

## **行为时间热图**
- X轴：时间
- Y轴：行为种类
- 值：行为是否发生

## **系统调用矩阵（CNN）**
- 不同系统调用映射为颜色/灰度值
- 转化为128×128灰度图
- 可用于CNN直接训练识别行为特征
  
假设有一下调用序列：
```
open → read → read → write → close
```
攻击者打开文件、读取数据等
  
### step1：建立调用字典
  每种调用映射一个唯一编号：
  
|调用|编号|
|---|---|
|open|1|
|read|2|
|write|3|
|close|4|
|connect|5|

### step2：转化为向量序列
调用序列转成编号（one- hot）

|调用名|One-hot 向量|
|---|---|
|open|[1, 0, 0, 0, 0]|
|read|[0, 1, 0, 0, 0]|
|write|[0, 0, 1, 0, 0]|
|close|[0, 0, 0, 1, 0]|
|connect|[0, 0, 0, 0, 1]|


### step3：构造矩阵

```
[
 [1, 0, 0, 0, 0],   ← open
 [0, 1, 0, 0, 0],   ← read
 [0, 1, 0, 0, 0],   ← read
 [0, 0, 1, 0, 0],   ← write
 [0, 0, 0, 1, 0]    ← close
]
```
（行是时间序列，列是系统调用种类）
- 标准化后映射到[0, 255]像素灰度值
- 直接转成图像用于CNN模型训练

```
图像矩阵（行为时间展开）：
时间轴 ↓   open  read  write  close  connect
       ┌───────────────────────────────┐
调用1   │ █      .     .      .      . │
调用2   │ .      █     .      .      . │
调用3   │ .      █     .      .      . │
调用4   │ .      .     █      .      . │
调用5   │ .      .     .      █      . │
        └───────────────────────────────┘

```
