APT攻击行为具有“**高级性、持续性、隐蔽性、定制化**”等特点
**APT攻击行为画像**是指基于网络数据、主机行为、日志信息等，提取APT攻击各阶段特征，通过建模与可视化方式形成的攻击者行为模式、攻击链路径和技术使用特征的综合表达。

## 攻击链信息
APT攻击通常遵循一条 **攻击生命周期链条**，例如 MITRE ATT&CK 框架定义的战术（Tactics）和技术（Techniques）链。

|阶段|内容|
|---|---|
|初始入侵（Initial Access）|钓鱼邮件、0day、供应链攻击等入口方式|
|执行（Execution）|恶意脚本运行、远程代码注入等|
|持久化（Persistence）|注册表修改、计划任务设置等|
|提权（Privilege Escalation）|利用提权漏洞、权限提升行为|
|防御规避（Defense Evasion）|加密通信、关闭日志、DLL注入等|
|凭证访问（Credential Access）|窃取账号、爆破、内存读取等|
|发现（Discovery）|主机信息收集、端口扫描、AD枚举等|
|横向移动（Lateral Movement）|RDP、Pass-the-Hash、WMI等工具|
|收集（Collection）|打包数据、摄像头、键盘记录|
|命令与控制（C2）|与远控服务器的通信（HTTP/TLS/DNS）|
|数据泄露/影响（Exfiltration/Impact）|上传数据、破坏系统、敲诈勒索等|

## 关键行为特征
APT攻击由一系列**细粒度的操作行为**构成，画像中应包含：
### 1. 行为内容（具体操作）
- 文件创建、修改、删除
- 注册表操作（Windows）
- 网络连接行为（IP/端口/DNS）
- 命令行输入
- 可疑进程链
- 加载的动态链接库（DLL）
- 外联C2地址和通信协议
### 2. 行为属性（元信息）
- 时间戳（行为发生的时间）
- 频率（单位时间内行为发生次数）
- 所属主机、进程、用户身份
- 是否为异常行为（通过基线判断）
### 3. 使用工具（攻击工具）
- 常见APT工具：CobaltStrike、Mimikatz、Empire、Metasploit
- 自研后门、脚本

### 上下文关联信息
APT攻击中不同行为之间存在明确的**因果关系或实体联系**。
### 1. 实体关系图（Who-What-Where）
- 用户名 ↔ 操作行为 ↔ 主机名
- 进程 ↔ 父子关系 ↔ 进程行为
- 文件 ↔ 哈希 ↔ 来源路径
- IP ↔ 通信对象 ↔ 域名/ASN/国家
### 2. 时间序列依赖
- 行为按时间顺序排列
- 形成[[攻击链路径图]]（如攻击路径图或行为图谱）

## 攻击者特征信息
### 1. APT家族或攻击团伙特征
- 使用的工具链是否有一致性？
- 通信基础设施是否可溯源？
- 技术特征是否与某APT组织匹配（如APT28, APT41）？
### 2. 行为模式特征（深度画像）
- 是否符合特定攻击者的攻击节奏、时间偏好、TTP组合？
- 是否存在**攻击者指纹（行为偏好）**？
  
## 结构化表示
示例：
```
{
  "攻击链阶段": ["初始入侵", "提权", "横向移动", "数据泄露"],
  "行为序列": [
    {"时间": "10:00", "主机": "host1", "行为": "运行PowerShell脚本", "工具": "Empire", "风险": "高"},
    {"时间": "10:03", "主机": "host1", "行为": "尝试访问共享目录", "用户": "admin", "风险": "中"},
    ...
  ],
  "关联实体图谱": {
    "用户": ["attacker", "admin"],
    "IP": ["10.1.1.5", "8.8.8.8"],
    "工具": ["Mimikatz", "RDP"],
    "C2域名": ["evil.com"]
  },
  "APT家族匹配": {
    "匹配家族": "APT29",
    "相似度": 0.83
  }
}
```