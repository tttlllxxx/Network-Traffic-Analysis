
本评价指标体系旨在全面评估图神经网络（GNN）在APT攻击识别任务中的表现，涵盖分类性能、阶段识别、图结构一致性、模型稳定性及异常检测等维度，并为后续的反馈优化机制提供量化基础。

---

## 一、分类性能指标

### 1.1 准确率（Accuracy）

- **评判方法**：  
 $$ Accuracy = \frac{TP + TN}{TP + TN + FP + FN}$$
- **数据来源**：  
  - 模型在测试集上的预测结果；
  - 实际标签（0=正常，1=攻击）。

- **用途分析**：  
  衡量整体预测正确率，但在类别不平衡时可能失真。

---

### 1.2 精确率（Precision）

- **评判方法**：  
  $$Precision = \frac{TP}{TP + FP}$$
- **数据来源**：  
  - 模型预测为“攻击”的样本；
  - 实际是否为攻击样本的标签。

- **用途分析**：  
  衡量误报率，越高说明误报越少。

---

### 1.3 召回率（Recall）

- **评判方法**：  
$$  Recall = \frac{TP}{TP + FN}$$
- **数据来源**：  
  - 所有真实攻击样本；
  - 其中被正确识别出来的数量。

- **用途分析**：  
  衡量漏报率，越高说明漏报越少。

---

### 1.4 F1-score

- **评判方法**：  
$$  F1 = 2 \cdot \frac{Precision \cdot Recall}{Precision + Recall}$$
- **数据来源**：  
  基于上两项计算。

- **用途分析**：  
  综合考虑误报和漏报，适合不平衡样本任务。

---

## 二、攻击阶段识别指标

### 2.1 分阶段精度指标（Per-Stage Accuracy / F1）

- **评判方法**：  
  对每个阶段单独计算 Accuracy、Precision、Recall、F1-score。

- **数据来源**：  
  - 节点级标签中包含攻击阶段编号（如 0-发现，1-进入，2-持久化...）；
  - 模型的阶段分类预测结果。

- **用途分析**：  
  反映模型在多阶段APT攻击行为识别中的精度分布，帮助定位模型在某一阶段识别上的薄弱点。

---

### 2.2 阶段切换捕捉率（Stage Transition Accuracy）

- **评判方法**：  
  对预测攻击链中阶段序列，与真实阶段序列进行相似度比较（编辑距离、重合度等）。

- **数据来源**：  
  - 实际攻击路径中节点的阶段编号；
  - 模型预测的阶段编号序列。

- **用途分析**：  
  检验模型是否准确识别攻击链中的阶段切换过程。

---

## 三、图结构一致性指标

### 3.1 路径还原度（Attack Path Recovery Rate）

- **评判方法**：  
$$  \text{Jaccard Similarity} = \frac{|P_{true} \cap P_{pred}|}{|P_{true} \cup P_{pred}|}$$
- **数据来源**：  
  - 真实攻击路径（人工标注或CTF题目日志）；
  - 模型识别的攻击路径（预测攻击节点及其连接关系）。

- **用途分析**：  
  衡量模型还原攻击链的能力，是APT检测任务中的关键结构指标。

---

### 3.2 子图结构匹配度（Subgraph Structural Similarity）

- **评判方法**：  
  使用 Graph Edit Distance（GED）、节点/边重合率进行结构相似性计算。

- **数据来源**：  
  - Ground Truth 攻击子图；
  - 模型预测的攻击子图。

- **用途分析**：  
  检查模型是否重构出与真实攻击逻辑一致的子图结构。

---

## 四、模型稳定性指标

### 4.1 训练稳定性（Performance Variance）

- **评判方法**：  
  多次训练模型，计算准确率/F1等指标的标准差。

- **数据来源**：  
  - 多次随机初始化模型；
  - 不同种子下重复实验结果。

- **用途分析**：  
  评估模型对训练初始化和数据扰动的鲁棒性。

---

### 4.2 对抗鲁棒性（Adversarial Robustness）

- **评判方法**：  
  在插入扰动节点、伪造行为或边的情况下，检测性能下降幅度。

- **数据来源**：  
  - 构造对抗攻击图；
  - 测试模型对这些干扰样本的表现。

- **用途分析**：  
  衡量模型对伪装攻击、规避行为的识别能力。

---

## 五、异常检测指标

### 5.1 误报率（False Positive Rate）

- **评判方法**：  
  $$FPR = \frac{FP}{FP + TN}$$
- **数据来源**：  
  - 模型错误识别为攻击的正常样本数；
  - 所有正常样本数。

- **用途分析**：  
  衡量模型是否“太敏感”，产生大量误报。

---

### 5.2 漏报率（False Negative Rate）

- **评判方法**：  
$$  FNR = \frac{FN}{FN + TP}$$
- **数据来源**：  
  - 模型漏检的攻击行为节点数；
  - 所有攻击节点数。

- **用途分析**：  
  评估模型是否遗漏关键攻击行为。

---

## 六、指标归一化与加权评分

所有指标将进行归一化处理（如最大-最小归一），并按权重合成：
$$\text{Final Score} = \sum_{i=1}^n w_i \cdot metric_i$$
其中 \( w_i \) 为各指标权重，可通过 AHP、专家打分或数据驱动方式设定。

---

## 七、用途总结

| 指标类型         | 核心用途                                |
|------------------|-----------------------------------------|
| 分类性能指标     | 基础分类能力评价                        |
| 阶段识别指标     | 多阶段攻击识别能力，指导细粒度反馈      |
| 图结构一致性指标 | 攻击链重建能力，评估图建模有效性        |
| 稳定性指标       | 判断模型是否稳定可靠                    |
| 异常检测指标     | 衡量误报、漏报对实际应用的影响          |

---
