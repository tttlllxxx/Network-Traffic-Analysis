
## 1. 引言

APT（高级持续性威胁）攻击具有高度隐蔽性、阶段性强、行为链复杂等特点。图神经网络（GNN）因其优秀的关系建模能力被广泛应用于网络安全场景，尤其适合建模攻击链行为。

然而，现有工作中常规的评价方法如精度、召回率等，无法有效反映模型在不同阶段APT识别中的真实表现，亦缺乏将评价结果反哺模型与图结构的机制。

因此，本机制旨在设计一套多维度的评价指标体系，并构建从“评价指标 → 图结构与模型反馈 → GNN优化”的闭环机制，提升模型在APT攻击识别任务中的精准性与稳定性。

---

## 2. 评价体系设计

### 2.1 分类性能指标（通用）

- **Accuracy** 准确率
- **Precision** 精确率
- **Recall** 召回率
- **F1-score** 平衡性能

### 2.2 阶段识别能力（APT特有）

- **阶段准确率**：针对初始访问、权限提升、横向移动、数据窃取等阶段分别计算F1值
- **攻击链完整性识别率**：识别出的攻击链完整程度，衡量模型能否还原真实攻击路径

### 2.3 鲁棒性与泛化能力

- **结构扰动鲁棒性**：节点丢失、边扰动后的性能下降程度
- **泛化性测试**：在未知攻击或组合攻击场景下的性能

### 2.4 模型可解释性维度

- 使用 **GNNExplainer**、**PGExplainer** 提取子图并计算解释能力
- **解释子图覆盖率**：覆盖真实攻击路径的比例

---

## 3. 反馈机制设计

### 3.1 指标 → 反馈路径映射表

| 评价指标 | 表示的问题 | 反馈路径 | 示例操作 |
|----------|------------|----------|----------|
| 某阶段 Recall 低 | 模型未能识别该阶段行为 | 图特征不充分 / 模型表达力弱 | 增强节点/边特征，调整子图采样策略 |
| 攻击链识别不完整 | 缺乏攻击链建模能力 | 边权设置 / 时间依赖缺失 | 引入边时间权重、因果建模模块 |
| 可解释性差 | 输出黑盒、难以理解 | 结构复杂 / 训练不稳定 | 添加 attention，简化模型结构 |
| 鲁棒性低 | 噪声影响大 | 过拟合 / 图结构欠拟合 | 使用 DropEdge、正则化增强鲁棒性 |

### 3.2 反馈形式设计

- **结构反馈**：调整图结构，优化节点选择、边权分配、连接策略；
- **特征反馈**：增强图节点或边的特征表示；
- **训练反馈**：重新分配 loss 权重、引入阶段惩罚机制；
- **模型反馈**：切换或调整 GNN 架构，如GCN→GAT→GIN。

---

## 4. 机制工作流程图


输入图结构 → GNN建模训练 → 得出多维度评价指标
        ↑                                      ↓
   反馈机制 ← 评价体系分析 ← 模型输出结果


说明：

- 构建模型后对其进行评价；
- 评价维度对比期望性能，分析性能弱项；
- 弱项通过“反馈路径”转化为图结构、特征或模型的改进策略；
- 形成“评价 → 反馈 → 优化 → 再评价”的闭环迭代过程。

---

## 5. 实施建议与挑战

### 5.1 实施建议

- 构建指标与反馈之间的映射模块；
- 将各类评价指标模块化，便于集成训练pipeline；
- 支持交互式可视化（如TensorBoard或自建Dashboard）观察反馈过程。

### 5.2 面临的挑战

- 如何构造具有可调特性的行为图？
- 指标反馈路径的自动化程度有限，仍需人工介入；
- 可解释性与性能提升存在权衡。

---

## 6. 小结

本设计文档提出了一种面向APT攻击行为识别任务的GNN模型评价-反馈机制：

- 设计了结合任务特性的多维评价体系；
- 构建了从指标到结构优化的反馈通道；
- 形成GNN建模的评价-优化闭环。

未来将基于此机制构建实验系统，验证其对模型性能提升的有效性。
