## 一、从流量中能提取出的信息（可观测层）

即使是 **加密流量（HTTPS / TLS / HTTP/2 / QUIC）**，**元特征**（metadata）：

| 类别        | 示例特征                   | 能反映的信息                  |
| --------- | ---------------------- | ----------------------- |
| **会话特征**  | 握手时间、TLS版本、ALPN协议、证书CN | 请求是HTTP/2、HTTP/3还是SSE流式 |
| **方向性特征** | 上下行包数量、比例、平均间隔         | 用户与模型交互模式（提问短、回答长）      |
| **时间特征**  | RTT分布、响应延迟、包间隔抖动       | 模型推理时间、是否流式输出           |
| **长度特征**  | 首包长度、最大包、累计字节数         | 响应内容的规模、可能的token数量      |
| **分块特征**  | 数据帧间隔、SSE分片节奏          | LLM生成token的速率和结构        |
| **并发特征**  | 并行连接数、keep-alive模式     | 是否有批量请求、后台任务或bot调用      |

这些信息**不包含内容本身**，但足以反映 API 使用行为特征。

## 二、从这些特征“推断”或“检测”的能力（推理层）

| 检测/分析目标       | 说明                                  | 可用特征               |
| ------------- | ----------------------------------- | ------------------ |
| **识别 LLM 流量** | 判断某条加密流量是不是 LLM API 调用（vs 普通HTTP请求） | 包长度、时间序列模式         |
| **区分 LLM 类型** | 区分是 OpenAI、Claude、Gemini 还是自建模型的API | TLS指纹、包分布特征、响应结构   |
| **识别提示类型**    | 推测是文本问答、图像生成、代码补全等任务                | 请求大小与响应时序          |
| **检测异常调用**    | 检测被滥用、越权、爬虫或Prompt Injection攻击      | 请求频率、token量异常、延迟突变 |
| **检测信息泄露**    | 当用户误上传敏感信息时，流量异常长或高熵                | 请求大小、时延统计          |
| **检测伪装或代理**   | 有人试图伪装非LLM流量绕过安全策略                  | TLS握手模式、特征不一致      |
| **行为画像**      | 分析用户或应用的使用习惯（如生成密度、对话频率）            | 长期流量统计             |
